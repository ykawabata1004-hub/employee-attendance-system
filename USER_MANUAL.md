# 在席・勤怠可視化システム 使い方説明書

## 📖 目次

1. [はじめに](#はじめに)
2. [起動方法](#起動方法)
3. [画面構成](#画面構成)
4. [機能別操作ガイド](#機能別操作ガイド)
   - [カレンダー表示](#1-カレンダー表示)
   - [一覧・検索](#2-一覧検索)
   - [ステータス登録](#3-ステータス登録)
   - [社員管理](#4-社員管理)
5. [データ管理](#データ管理)
6. [よくある質問](#よくある質問)

---

## はじめに

本システムは、欧州拠点（LDN/DSS/HBG/PRS/MIL）の社員の勤務状況を一元管理するWebアプリケーションです。

### 主な機能
- 📅 カレンダー形式での勤務状況可視化
- 📋 在席状況の一覧表示・検索
- ✏️ 勤務ステータスの登録・編集
- 👥 社員マスタの管理
- 💾 データのインポート・エクスポート

### 対応ブラウザ
- Google Chrome（最新版）
- Microsoft Edge（最新版）
- Firefox（最新版）

---

## 起動方法

### 初回起動

1. `employee-attendance-calendar` フォルダ内の `index.html` をダブルクリック
2. ブラウザが起動し、アプリケーションが表示されます
3. 初回起動時は自動的にサンプルデータが生成されます

### 2回目以降

- 同様に `index.html` を開くだけで起動します
- 前回入力したデータは保持されています（ブラウザのローカルストレージに保存）

---

## 画面構成

### ヘッダー
- アプリケーション名と説明が表示されます

### ナビゲーションタブ
4つのメイン機能にアクセスできます:
- **📅 カレンダー**: 勤務状況をカレンダー形式で表示
- **📋 一覧・検索**: 在席状況を一覧表示・検索
- **✏️ ステータス登録**: 勤務ステータスを登録・編集
- **👥 社員管理**: 社員情報とデータを管理

---

## 機能別操作ガイド

### 1. カレンダー表示

社員の勤務状況をカレンダー形式で確認できます。

#### 基本操作

**表示モードの切り替え**
- **日**: 特定日の全社員の勤務状況を一覧表示
- **週**: 1週間分のカレンダーを表示
- **月**: 1ヶ月分のカレンダーを表示（デフォルト）

**期間の移動**
- **← 前**: 前の期間（日/週/月）へ移動
- **今日**: 今日を含む期間へ戻る
- **次 →**: 次の期間（日/週/月）へ移動

**フィルタリング**
- **拠点**: LDN/DSS/HBG/PRS/MILから選択
- **部署**: 営業部/経理部/総務部などから選択
- **社員**: 特定の社員を選択

#### ステータスの色分け

カレンダー上で各ステータスは色分けされています:
- 🟢 **緑**: オフィス勤務
- 🔵 **青**: 在宅勤務（WFH）
- 🟠 **オレンジ**: 出張
- 🟣 **紫**: 外出
- 🔴 **赤**: 休暇
- ⚫ **グレー**: 病欠

#### 詳細表示

**月間ビュー**
- カレンダーの日付をクリックすると、その日の詳細（日次ビュー）に切り替わります
- 各日には最大3件の勤務状況が表示され、それ以上ある場合は「+N件」と表示されます

**日次ビュー**
- 全社員の勤務状況が表形式で表示されます
- 社員名、拠点、部署、ステータス、備考が確認できます

---

### 2. 一覧・検索

特定日の在席状況を確認し、検索・フィルタリングができます。

#### 基本操作

**日付選択**
1. 「日付」フィールドで確認したい日付を選択
2. 自動的に一覧が更新されます

**検索**
1. 検索ボックスに社員名を入力
2. 入力に応じて一覧が絞り込まれます

**フィルタリング**
- **拠点**: 特定拠点の社員のみ表示
- **部署**: 特定部署の社員のみ表示
- **ステータス**: 特定ステータスの社員のみ表示

**ソート**
- テーブルのヘッダー（社員名、拠点、部署、ステータス）をクリックすると、その列でソートされます
- 再度クリックすると昇順/降順が切り替わります

#### 統計情報

画面下部に以下の統計が表示されます:
- **総社員数**: フィルター条件に該当する社員の総数
- **連絡可能**: オフィス勤務・在宅勤務の社員数
- **連絡不可**: 出張・外出・休暇・病欠の社員数
- **ステータス別内訳**: 各ステータスの人数

---

### 3. ステータス登録

社員の勤務ステータスを登録・編集します。

#### 新規登録

1. **社員を選択**: ドロップダウンから対象社員を選択
2. **日付を入力**:
   - **開始日**: 必須。ステータスの開始日
   - **終了日**: 任意。期間指定する場合のみ入力
3. **ステータスを選択**: 
   - オフィス勤務
   - 在宅勤務
   - 出張
   - 外出
   - 休暇
   - 病欠
4. **備考を入力**: 任意。出張先や外出理由などを記入
5. **「登録」ボタンをクリック**

#### 期間一括登録

開始日と終了日を両方入力すると、その期間すべてに同じステータスが登録されます。

**例**: 2026年2月17日〜2月21日を「出張」で登録
- 開始日: 2026-02-17
- 終了日: 2026-02-21
- ステータス: 出張
- 備考: ロンドン出張

→ 5日間すべてに「出張」が登録されます

#### 編集・削除

**編集**
1. 「最近の登録」テーブルで編集したい行の「編集」ボタンをクリック
2. フォームに既存データが入力されます
3. 内容を修正して「更新」ボタンをクリック

**削除**
1. 「最近の登録」テーブルで削除したい行の「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック

---

### 4. 社員管理

社員マスタの管理とデータのインポート・エクスポートを行います。

#### 社員の追加

1. **「+ 新規社員追加」ボタンをクリック**
2. モーダルウィンドウが表示されます
3. 以下の情報を入力:
   - **氏名**: 必須
   - **拠点**: LDN/DSS/HBG/PRS/MILから選択
   - **部署**: 必須
   - **役職**: 必須
   - **メールアドレス**: 必須
4. **「追加」ボタンをクリック**

#### 社員の編集

1. 社員一覧で編集したい社員の「編集」ボタンをクリック
2. モーダルウィンドウに既存データが表示されます
3. 内容を修正して「更新」ボタンをクリック

#### 社員の削除

1. 社員一覧で削除したい社員の「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック
3. **注意**: 関連する勤怠記録も削除されます

#### CSVインポート（Concur / iTrent）

ConcurやiTrentから出力したCSVファイルをインポートして、出張データや休暇データを一括登録できます。

**Concur CSVインポート（出張データ）**

1. 社員管理画面の「📊 Concur CSV インポート」ボタンをクリック
2. インポート範囲を選択:
   - **全社員**: すべての社員のデータをインポート
   - **拠点別**: 特定拠点の社員のみインポート
   - **個人別**: 特定の社員のみインポート
3. CSVファイルを選択（フォーマット: 社員ID, 氏名, 出張開始日, 出張終了日, 出張先）
4. 「インポート」ボタンをクリック

**iTrent CSVインポート（休暇データ）**

1. 社員管理画面の「📋 iTrent CSV インポート」ボタンをクリック
2. インポート範囲を選択（全社員/拠点別/個人別）
3. CSVファイルを選択（フォーマット: 社員ID, 氏名, 休暇開始日, 休暇終了日, 休暇種別, 有給残日数）
4. 「インポート」ボタンをクリック

**サンプルCSVのダウンロード**
- 各インポートモーダルで「サンプルCSVをダウンロード」ボタンをクリックすると、フォーマット例をダウンロードできます

**注意事項**:
- CSVファイルの社員IDが社員マスタに存在しない場合、そのデータはスキップされます
- 既存の勤怠データと日付が重複する場合、上書きされます



## データ管理

### データエクスポート

全データをJSON形式でダウンロードできます。

1. 社員管理画面の「データエクスポート (JSON)」ボタンをクリック
2. `attendance-data-YYYY-MM-DD.json` ファイルがダウンロードされます
3. このファイルには以下が含まれます:
   - 全社員データ
   - 全勤怠記録
   - エクスポート日時

**用途**:
- バックアップ
- 他のシステムへのデータ移行
- データ分析

### データインポート

JSON形式のデータファイルを読み込みます。

1. 社員管理画面の「データインポート (JSON)」ボタンをクリック
2. ファイル選択ダイアログが表示されます
3. JSONファイルを選択
4. 確認ダイアログで「OK」をクリック
5. **注意**: 既存データは上書きされます

### 全データクリア

すべてのデータを削除します。

1. 社員管理画面の「全データクリア」ボタンをクリック
2. 2回の確認ダイアログで「OK」をクリック
3. **注意**: この操作は取り消せません

### サンプルデータ再生成

デモ用のサンプルデータを再生成します。

1. 社員管理画面の「サンプルデータ再生成」ボタンをクリック
2. 以下のデータが生成されます:
   - 10名の社員（各拠点2名ずつ）
   - 今月の勤怠記録（平日のみ）

**用途**:
- デモ・テスト
- データをリセットして最初からやり直す

---

## よくある質問

### Q1. データはどこに保存されますか?

**A**: ブラウザのローカルストレージに保存されます。サーバーには送信されません。

### Q2. データが消えることはありますか?

**A**: 以下の場合にデータが消える可能性があります:
- ブラウザのキャッシュをクリアした場合
- ブラウザのデータを削除した場合
- 別のブラウザで開いた場合

**対策**: 定期的にデータエクスポートでバックアップを取ることをお勧めします。

### Q3. 複数人で同じデータを共有できますか?

**A**: 現在のバージョンでは、各ブラウザで独立したデータを保持します。共有するには:
1. データエクスポートでJSONファイルを作成
2. 他の人にファイルを送信
3. 受け取った人がデータインポートで読み込む

### Q4. 過去のデータを確認できますか?

**A**: はい。カレンダーや一覧・検索で過去の日付を選択すれば確認できます。

### Q5. 土日のデータは登録できますか?

**A**: はい。カレンダーには土日も表示され、登録も可能です。

### Q6. 同じ日に複数のステータスを登録できますか?

**A**: いいえ。1人の社員につき1日1つのステータスのみ登録できます。同じ日に再度登録すると、既存のデータが上書きされます。

### Q7. エラーが発生した場合はどうすればいいですか?

**A**: 以下を試してください:
1. ページをリロード（F5キー）
2. ブラウザを再起動
3. それでも解決しない場合は、ブラウザのコンソール（F12キー）でエラーメッセージを確認

### Q8. モバイルで使用できますか?

**A**: 現在のバージョンはデスクトップ・タブレット向けに最適化されています。スマートフォンでも動作しますが、画面が小さいため操作しづらい場合があります。

---

## サポート

ご不明な点がございましたら、システム管理者までお問い合わせください。

---

**バージョン**: 1.0  
**最終更新**: 2026年2月16日
